<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th√≠ Nghi·ªám: T√≠nh Ch·∫•t 3 ƒê∆∞·ªùng Trung Tuy·∫øn</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Th√™m font ch·ªØ d·ªÖ th∆∞∆°ng -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Quicksand', sans-serif; user-select: none; }
        .data-card { transition: all 0.3s ease; }
        .data-card:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        
        /* Input ƒëi·ªÅn khuy·∫øt */
        .fill-input {
            border: 2px solid #f9a8d4; /* pink-300 */
            border-radius: 12px;
            padding: 8px 12px;
            color: #831843; /* pink-900 */
            outline: none;
            width: 100%;
            margin-bottom: 8px;
            font-weight: bold;
            background-color: #fff1f2;
        }
        .fill-input:focus { border-color: #db2777; background-color: #fff; }
        
        .cute-btn {
            background: linear-gradient(to right, #ec4899, #8b5cf6);
            border-radius: 12px;
            color: white;
            font-weight: bold;
            padding: 8px 16px;
            transition: transform 0.1s;
            box-shadow: 0 4px 0 #9d174d;
        }
        .cute-btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #9d174d;
        }
        .cute-btn.disabled {
            background: #d1d5db;
            box-shadow: none;
            cursor: not-allowed;
            transform: none;
        }
    </style>
</head>
<body class="bg-purple-50 min-h-screen flex flex-col p-4">

    <header class="text-center mb-6">
        <h1 class="text-4xl font-bold text-purple-900 mb-1">üåü KH√ÅM PH√Å TR·ªåNG T√ÇM üåü</h1>
        <p class="text-purple-600 font-semibold">K√©o c√°c ƒë·ªânh A, B, C ƒë·ªÉ c√πng l√†m th√°m t·ª≠ to√°n h·ªçc nh√©!</p>
    </header>

    <div class="flex flex-col lg:flex-row gap-6 max-w-7xl mx-auto w-full flex-1">
        
        <!-- Khu v·ª±c v·∫Ω -->
        <div class="flex-1 bg-white rounded-3xl shadow-xl border-4 border-purple-200 relative overflow-hidden h-[600px] lg:h-auto cursor-crosshair">
            <canvas id="geoCanvas"></canvas>
            <div class="absolute bottom-4 left-4 bg-white/90 p-3 rounded-xl shadow-lg border-2 border-purple-100 text-sm">
                <label class="flex items-center space-x-2 cursor-pointer">
                    <input type="checkbox" id="showMedians" checked class="form-checkbox text-purple-600 h-6 w-6 rounded-md border-2 border-purple-300 focus:ring-purple-500">
                    <span class="font-bold text-purple-800">Hi·ªán 3 ƒë∆∞·ªùng trung tuy·∫øn</span>
                </label>
            </div>
        </div>

        <!-- Khu v·ª±c s·ªë li·ªáu & S·ªï tay -->
        <div class="w-full lg:w-[450px] space-y-6">
            
            <!-- B·∫£ng k·∫øt qu·∫£ -->
            <div class="bg-white p-6 rounded-3xl shadow-lg border-2 border-pink-100">
                <h3 class="font-bold text-gray-800 mb-4 flex items-center text-lg">
                    <span class="bg-pink-500 text-white w-8 h-8 rounded-full flex items-center justify-center mr-2 shadow">1</span>
                    ƒêo ƒë·∫°c th·ª±c t·∫ø
                </h3>
                
                <div class="space-y-3">
                    <div class="flex flex-col p-3 bg-pink-50 rounded-xl data-card border-l-4 border-pink-500">
                        <span class="text-gray-600 text-sm mb-1 font-semibold">ƒê·ªô d√†i AM (Trung tuy·∫øn ƒë·ªânh A):</span>
                        <span id="len-am" class="font-bold text-pink-600 text-2xl">0</span>
                    </div>
                    <div class="flex flex-col p-3 bg-yellow-50 rounded-xl data-card border-l-4 border-yellow-500">
                        <span class="text-gray-600 text-sm mb-1 font-semibold">ƒê·ªô d√†i AG (T·ª´ ƒë·ªânh A ƒë·∫øn Giao ƒëi·ªÉm):</span>
                        <span id="len-ag" class="font-bold text-yellow-600 text-2xl">0</span>
                    </div>
                    
                    <div class="pt-2 border-t border-dashed border-gray-300">
                        <div class="flex justify-between items-center p-3 bg-indigo-50 border-2 border-indigo-200 rounded-xl data-card">
                            <span class="font-bold text-indigo-900">T·ªâ s·ªë AG / AM:</span>
                            <button id="btn-calc-ratio" class="cute-btn text-sm bg-gradient-to-r from-indigo-500 to-blue-500 box-shadow-indigo">
                                T√≠nh ngay üßÆ
                            </button>
                            <span id="ratio" class="hidden font-bold text-indigo-600 text-2xl animate-pulse">0.666...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- S·ªï tay th√°m t·ª≠ (K·∫øt lu·∫≠n) -->
            <div class="bg-gradient-to-br from-pink-100 to-purple-100 p-6 rounded-3xl shadow-xl border-4 border-white">
                <h3 class="font-bold mb-4 flex items-center text-purple-900 text-xl">
                    <span class="text-2xl mr-2">üìù</span>
                    S·ªï Tay To√°n H·ªçc
                </h3>
                
                <div class="space-y-6">
                    <!-- T√≠nh ch·∫•t 1 -->
                    <div class="bg-white p-4 rounded-2xl shadow-sm border border-pink-200 relative">
                        <div class="absolute -top-3 -left-3 bg-pink-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow">T√≠nh ch·∫•t 1</div>
                        <p class="mb-2 text-gray-700 font-medium mt-2">Ba ƒë∆∞·ªùng trung tuy·∫øn c·ªßa tam gi√°c lu√¥n...</p>
                        
                        <div id="input-area-1">
                            <input type="text" id="input-1" class="fill-input" placeholder="Nh·∫≠p nh·∫≠n x√©t c·ªßa em...">
                            <button id="btn-submit-1" class="cute-btn w-full mt-1">Ch·ªët ƒë√°p √°n ‚ú®</button>
                        </div>

                        <div id="ans-1" class="hidden mt-2 p-3 bg-green-50 rounded-xl border-2 border-green-300 text-center animate-bounce-in">
                            <p class="font-bold text-green-800 text-sm leading-relaxed">
                                Ba ƒë∆∞·ªùng trung tuy·∫øn c·ªßa m·ªôt tam gi√°c c√πng ƒëi qua m·ªôt ƒëi·ªÉm. ƒêi·ªÉm ƒë√≥ g·ªçi l√† <span class="text-green-600 font-extrabold uppercase">tr·ªçng t√¢m</span>.
                            </p>
                        </div>
                    </div>

                    <!-- T√≠nh ch·∫•t 2 -->
                    <div class="bg-white p-4 rounded-2xl shadow-sm border border-purple-200 relative">
                        <div class="absolute -top-3 -left-3 bg-purple-600 text-white text-xs font-bold px-2 py-1 rounded-full shadow">T√≠nh ch·∫•t 2</div>
                        <p class="mb-2 text-gray-700 font-medium mt-2">Tr·ªçng t√¢m c√°ch m·ªói ƒë·ªânh m·ªôt kho·∫£ng b·∫±ng bao nhi√™u ph·∫ßn ƒë·ªô d√†i ƒë∆∞·ªùng trung tuy·∫øn?</p>
                        
                        <div id="input-area-2">
                            <!-- ƒê√£ x√≥a g·ª£i √Ω 2/3 trong placeholder -->
                            <input type="text" id="input-2" class="fill-input" placeholder="Nh·∫≠p t·ªâ s·ªë d·ª± ƒëo√°n...">
                            <button id="btn-submit-2" class="cute-btn w-full mt-1">Ch·ªët ƒë√°p √°n ‚ú®</button>
                        </div>

                        <div id="ans-2" class="hidden mt-2 p-3 bg-yellow-50 rounded-xl border-2 border-yellow-300 text-center">
                            <p class="font-bold text-yellow-800 text-sm mb-3 leading-relaxed">
                                Tr·ªçng t√¢m c√°ch m·ªói ƒë·ªânh m·ªôt kho·∫£ng b·∫±ng <span class="text-xl text-yellow-600 font-bold bg-white px-2 py-1 rounded shadow-sm">2/3</span> ƒë·ªô d√†i ƒë∆∞·ªùng trung tuy·∫øn ƒëi qua ƒë·ªânh ·∫•y.
                            </p>
                            
                            <!-- Canvas Minh H·ªça -->
                            <div class="flex justify-center flex-col items-center">
                                <canvas id="miniCanvas" width="240" height="130" class="bg-white rounded-lg border border-yellow-200 shadow-sm"></canvas>
                                <p class="text-[10px] text-gray-500 mt-1 italic">C√°c ƒëo·∫°n th·∫≥ng c√≥ c√πng s·ªë v·∫°ch th√¨ b·∫±ng nhau</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        {
            const canvas = document.getElementById('geoCanvas');
            const ctx = canvas.getContext('2d');
            let width, height;
            let ratioRevealed = false;

            // T·ªça ƒë·ªô c√°c ƒëi·ªÉm
            const A = { x: 0, y: 0, label: 'A', color: '#4f46e5' };
            const B = { x: 0, y: 0, label: 'B', color: '#4f46e5' };
            const C = { x: 0, y: 0, label: 'C', color: '#4f46e5' };
            let dragPoint = null;

            function resize() {
                // TƒÉng chi·ªÅu cao canvas ch√≠nh ƒë·ªÉ d·ªÖ k√©o
                width = canvas.parentElement.clientWidth;
                height = canvas.parentElement.clientHeight;
                canvas.width = width * window.devicePixelRatio;
                canvas.height = height * window.devicePixelRatio;
                canvas.style.width = width + 'px';
                canvas.style.height = height + 'px';
                ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
            }

            function initPoints() {
                A.x = width / 2; A.y = 80;
                B.x = 100; B.y = height - 100;
                C.x = width - 100; C.y = height - 100;
            }

            function dist(p1, p2) {
                return Math.sqrt((p1.x - p2.x)**2 + (p1.y - p2.y)**2);
            }

            function getMidpoint(p1, p2) {
                return { x: (p1.x + p2.x) / 2, y: (p1.y + p2.y) / 2 };
            }

            function draw() {
                ctx.clearRect(0, 0, width, height);
                const showMedians = document.getElementById('showMedians').checked;

                // Trung ƒëi·ªÉm
                const M = getMidpoint(B, C);
                const N = getMidpoint(A, C);
                const P = getMidpoint(A, B);

                // Tr·ªçng t√¢m
                const G = {
                    x: (A.x + B.x + C.x) / 3,
                    y: (A.y + B.y + C.y) / 3
                };

                // V·∫Ω trung tuy·∫øn v·ªõi m√†u s·∫Øc r√µ r√†ng (ƒê·ªè - Xanh D∆∞∆°ng - Xanh L√°)
                if (showMedians) {
                    ctx.lineWidth = 3; // TƒÉng ƒë·ªô d√†y n√©t v·∫Ω
                    
                    // AM - M√†u ƒê·ªè
                    ctx.beginPath(); ctx.moveTo(A.x, A.y); ctx.lineTo(M.x, M.y);
                    ctx.strokeStyle = '#ef4444'; // Red-500
                    ctx.setLineDash([6, 6]); ctx.stroke();
                    
                    // BN - M√†u Xanh D∆∞∆°ng (Blue)
                    ctx.beginPath(); ctx.moveTo(B.x, B.y); ctx.lineTo(N.x, N.y);
                    ctx.strokeStyle = '#3b82f6'; // Blue-500
                    ctx.setLineDash([6, 6]); ctx.stroke();

                    // CP - M√†u Xanh L√° (Green)
                    ctx.beginPath(); ctx.moveTo(C.x, C.y); ctx.lineTo(P.x, P.y);
                    ctx.strokeStyle = '#22c55e'; // Green-500
                    ctx.setLineDash([6, 6]); ctx.stroke();
                    
                    ctx.setLineDash([]);
                }

                // V·∫Ω tam gi√°c
                ctx.beginPath();
                ctx.moveTo(A.x, A.y); ctx.lineTo(B.x, B.y); ctx.lineTo(C.x, C.y); ctx.closePath();
                ctx.strokeStyle = '#4c1d95'; // Violet-900 (M√†u ƒë·∫≠m h∆°n cho vi·ªÅn)
                ctx.lineWidth = 5; ctx.lineJoin = 'round'; ctx.stroke();

                // Highlight ƒëo·∫°n AG
                if (showMedians) {
                    // T√¥ ƒë·∫≠m ƒëo·∫°n AG
                    ctx.beginPath(); ctx.moveTo(A.x, A.y); ctx.lineTo(G.x, G.y);
                    ctx.strokeStyle = '#b91c1c'; // Red-700
                    ctx.lineWidth = 5; ctx.stroke();
                    
                    // ƒêi·ªÉm G
                    ctx.beginPath(); ctx.arc(G.x, G.y, 8, 0, Math.PI*2);
                    ctx.fillStyle = '#fbbf24'; ctx.fill(); // Amber
                    ctx.strokeStyle = '#000'; ctx.lineWidth=2; ctx.stroke();
                    ctx.fillStyle = '#000'; ctx.font = 'bold 18px Quicksand'; ctx.fillText('G', G.x + 12, G.y);
                }

                // V·∫Ω ƒëi·ªÉm v√† nh√£n
                drawPoint(A, 'A', 'top'); 
                drawPoint(B, 'B', 'left'); 
                drawPoint(C, 'C', 'right');
                
                if(showMedians) {
                    drawPoint(M, 'M', 'bottom');
                    drawPoint(N, 'N', 'right');
                    drawPoint(P, 'P', 'left');
                }

                updateStats(A, M, G);
            }

            function drawPoint(p, label, pos) {
                ctx.beginPath(); ctx.arc(p.x, p.y, 7, 0, Math.PI*2);
                ctx.fillStyle = '#fff'; ctx.fill();
                ctx.strokeStyle = '#4c1d95'; ctx.lineWidth = 3; ctx.stroke();
                
                ctx.fillStyle = '#4c1d95'; ctx.font = 'bold 16px Quicksand';
                
                let tx = p.x - 5, ty = p.y - 12;
                if(pos === 'top') ty -= 5;
                if(pos === 'bottom') ty += 28;
                if(pos === 'left') tx -= 15;
                if(pos === 'right') tx += 15;
                
                ctx.fillText(label, tx, ty);
            }

            function updateStats(A, M, G) {
                const dAM = dist(A, M);
                const dAG = dist(A, G);
                const scale = 0.05;
                const valAM = (dAM * scale).toFixed(1);
                const valAG = (dAG * scale).toFixed(1);
                const ratio = (dAG / dAM); 

                document.getElementById('len-am').innerText = valAM + ' cm';
                document.getElementById('len-ag').innerText = valAG + ' cm';
                
                if (ratioRevealed) {
                    let ratioText = ratio.toFixed(4);
                    if (Math.abs(ratio - 2/3) < 0.01) {
                        ratioText = "‚âà 2/3 (" + ratio.toFixed(2) + ")";
                    }
                    document.getElementById('ratio').innerText = ratioText;
                }
            }

            // --- MINI CANVAS LOGIC (V·∫Ω h√¨nh minh h·ªça ch·ªët t√≠nh ch·∫•t) ---
            function drawMiniDiagram() {
                const miniCanvas = document.getElementById('miniCanvas');
                const mCtx = miniCanvas.getContext('2d');
                mCtx.clearRect(0,0, 240, 130);
                
                // T·ªça ƒë·ªô mini (Tam gi√°c th∆∞·ªùng)
                const mA = {x: 80, y: 20}; // ƒê·ªânh A l·ªách tr√°i ƒë·ªÉ th√†nh tam gi√°c th∆∞·ªùng
                const mB = {x: 30, y: 110};
                const mC = {x: 210, y: 110};
                
                // H√†m t√≠nh trung ƒëi·ªÉm
                function getMid(p1, p2) { return {x: (p1.x+p2.x)/2, y: (p1.y+p2.y)/2}; }
                
                const mM = getMid(mB, mC); // Trung ƒëi·ªÉm BC
                const mN = getMid(mA, mC); // Trung ƒëi·ªÉm AC
                const mP = getMid(mA, mB); // Trung ƒëi·ªÉm AB
                
                // Tr·ªçng t√¢m G
                const mG = {x: (mA.x + mB.x + mC.x)/3, y: (mA.y + mB.y + mC.y)/3};

                // V·∫Ω 3 trung tuy·∫øn m·ªù h∆°n ch√∫t
                mCtx.lineWidth = 1.5;
                
                // AM (ƒê·ªè nh·∫°t)
                mCtx.beginPath(); mCtx.moveTo(mA.x, mA.y); mCtx.lineTo(mM.x, mM.y); 
                mCtx.strokeStyle = '#f87171'; mCtx.stroke(); // Red-400
                
                // BN (Xanh nh·∫°t)
                mCtx.beginPath(); mCtx.moveTo(mB.x, mB.y); mCtx.lineTo(mN.x, mN.y); 
                mCtx.strokeStyle = '#60a5fa'; mCtx.stroke(); // Blue-400
                
                // CP (L·ª•c nh·∫°t)
                mCtx.beginPath(); mCtx.moveTo(mC.x, mC.y); mCtx.lineTo(mP.x, mP.y); 
                mCtx.strokeStyle = '#4ade80'; mCtx.stroke(); // Green-400

                // V·∫Ω tam gi√°c ch√≠nh (ƒê·∫≠m)
                mCtx.beginPath(); mCtx.moveTo(mA.x, mA.y); mCtx.lineTo(mB.x, mB.y); mCtx.lineTo(mC.x, mC.y); mCtx.closePath();
                mCtx.strokeStyle = '#374151'; mCtx.lineWidth = 2; mCtx.stroke();

                // === V·∫º V·∫†CH CHIA T·ªà L·ªÜ ===
                // H√†m v·∫Ω v·∫°ch (tick marks)
                function drawTick(p1, p2, count, color) {
                    const midX = (p1.x + p2.x)/2;
                    const midY = (p1.y + p2.y)/2;
                    // Vector ch·ªâ ph∆∞∆°ng
                    let dx = p2.x - p1.x;
                    let dy = p2.y - p1.y;
                    // Vector ph√°p tuy·∫øn chu·∫©n h√≥a
                    const len = Math.sqrt(dx*dx + dy*dy);
                    dx /= len; dy /= len;
                    const nx = -dy; const ny = dx;
                    
                    mCtx.beginPath();
                    mCtx.strokeStyle = color;
                    mCtx.lineWidth = 2;
                    const size = 3; // ƒê·ªô d√†i v·∫°ch
                    const gap = 3;  // Kho·∫£ng c√°ch gi·ªØa c√°c v·∫°ch
                    const startOffset = -((count-1)*gap)/2;
                    
                    for(let i=0; i<count; i++) {
                        const off = startOffset + i*gap;
                        // D·ªãch chuy·ªÉn theo ph√°p tuy·∫øn ƒë·ªÉ v·∫Ω v·∫°ch vu√¥ng g√≥c
                        mCtx.moveTo(midX - nx*size + dx*off, midY - ny*size + dy*off);
                        mCtx.lineTo(midX + nx*size + dx*off, midY + ny*size + dy*off);
                    }
                    mCtx.stroke();
                }

                // 1. Chia AM (ƒê·ªè): AG = 2 ƒëo·∫°n, GM = 1 ƒëo·∫°n => Trung ƒëi·ªÉm K c·ªßa AG
                const mK = getMid(mA, mG);
                // V·∫Ω 1 v·∫°ch ƒë·ªè tr√™n AK, KG, GM
                drawTick(mA, mK, 1, '#dc2626');
                drawTick(mK, mG, 1, '#dc2626');
                drawTick(mG, mM, 1, '#dc2626');
                
                // V·∫Ω ch·∫•m tr√≤n ƒë·ªÉ th·ªÉ hi·ªán r√µ 2 ƒëo·∫°n AG
                mCtx.beginPath(); mCtx.arc(mK.x, mK.y, 2, 0, Math.PI*2); mCtx.fillStyle = '#dc2626'; mCtx.fill();

                // 2. Chia BN (Xanh): BG = 2 ƒëo·∫°n, GN = 1 ƒëo·∫°n => Trung ƒëi·ªÉm L c·ªßa BG
                const mL = getMid(mB, mG);
                // V·∫Ω 2 v·∫°ch xanh tr√™n BL, LG, GN
                drawTick(mB, mL, 2, '#2563eb');
                drawTick(mL, mG, 2, '#2563eb');
                drawTick(mG, mN, 2, '#2563eb');
                
                // V·∫Ω ch·∫•m tr√≤n trung ƒëi·ªÉm BG
                mCtx.beginPath(); mCtx.arc(mL.x, mL.y, 2, 0, Math.PI*2); mCtx.fillStyle = '#2563eb'; mCtx.fill();

                // 3. Chia CP (L·ª•c): CG = 2 ƒëo·∫°n, GP = 1 ƒëo·∫°n => Trung ƒëi·ªÉm Q c·ªßa CG
                const mQ = getMid(mC, mG);
                // V·∫Ω 3 v·∫°ch l·ª•c tr√™n CQ, QG, GP
                drawTick(mC, mQ, 3, '#15803d');
                drawTick(mQ, mG, 3, '#15803d');
                drawTick(mG, mP, 3, '#15803d');
                
                // V·∫Ω ch·∫•m tr√≤n trung ƒëi·ªÉm CG
                mCtx.beginPath(); mCtx.arc(mQ.x, mQ.y, 2, 0, Math.PI*2); mCtx.fillStyle = '#15803d'; mCtx.fill();

                // V·∫Ω ƒëi·ªÉm G n·ªïi b·∫≠t
                mCtx.beginPath(); mCtx.arc(mG.x, mG.y, 3, 0, Math.PI*2);
                mCtx.fillStyle = '#fbbf24'; mCtx.fill();
                mCtx.strokeStyle = '#000'; mCtx.lineWidth = 1; mCtx.stroke();
                
                // Labels
                mCtx.fillStyle = '#000'; mCtx.font = 'bold 10px Quicksand';
                mCtx.fillText("A", mA.x-3, mA.y-5);
                mCtx.fillText("B", mB.x-10, mB.y+5);
                mCtx.fillText("C", mC.x+5, mC.y+5);
                mCtx.fillText("G", mG.x+5, mG.y+3);
                
                mCtx.fillText("M", mM.x-3, mM.y+10);
                mCtx.fillText("N", mN.x+3, mN.y+3);
                mCtx.fillText("P", mP.x-8, mP.y+3);
            }

            // Event Listeners
            document.getElementById('btn-submit-1').addEventListener('click', () => {
                const input = document.getElementById('input-1').value.trim();
                if(input) {
                    document.getElementById('input-area-1').classList.add('hidden');
                    document.getElementById('ans-1').classList.remove('hidden');
                } else alert("Em ch∆∞a nh·∫≠p c√¢u tr·∫£ l·ªùi n√®!");
            });

            document.getElementById('btn-submit-2').addEventListener('click', () => {
                const input = document.getElementById('input-2').value.trim();
                if(input) {
                    document.getElementById('input-area-2').classList.add('hidden');
                    document.getElementById('ans-2').classList.remove('hidden');
                    drawMiniDiagram(); // V·∫Ω h√¨nh minh h·ªça khi ch·ªët
                } else alert("Em ch∆∞a nh·∫≠p t·ªâ s·ªë n√®!");
            });

            document.getElementById('btn-calc-ratio').addEventListener('click', () => {
                ratioRevealed = true;
                document.getElementById('btn-calc-ratio').classList.add('hidden');
                document.getElementById('ratio').classList.remove('hidden');
                draw();
            });

            // Interaction logic (same as before)
            function getMousePos(e) {
                const rect = canvas.getBoundingClientRect();
                return { x: e.clientX - rect.left, y: e.clientY - rect.top };
            }
            canvas.addEventListener('mousedown', (e) => {
                const pos = getMousePos(e);
                if (dist(pos, A) < 30) dragPoint = A;
                else if (dist(pos, B) < 30) dragPoint = B;
                else if (dist(pos, C) < 30) dragPoint = C;
            });
            window.addEventListener('mousemove', (e) => {
                if (dragPoint) {
                    const rect = canvas.getBoundingClientRect();
                    dragPoint.x = e.clientX - rect.left;
                    dragPoint.y = e.clientY - rect.top;
                    draw();
                }
            });
            window.addEventListener('mouseup', () => dragPoint = null);
            document.getElementById('showMedians').addEventListener('change', draw);

            // Init
            setTimeout(() => {
                resize();
                initPoints();
                draw();
            }, 100);
            window.addEventListener('resize', () => { resize(); initPoints(); draw(); });
        }
    </script>
</body>
</html>
